# Лабораторная Работа 5
__Выполнил: де Джофрой, Мишель__

## 1. Квоты на процессор для конкретного пользователя (cgroups v2):

### 1.1 Создайте пользователя: user-ID (например, user-72).

```
useradd user-42
```

### 1.2 Назначьте квоту процессора на основе номера пользователя:
- Если имя пользователя заканчивается на **0-30**: 30% CPU.
- Если имя пользователя заканчивается на **31-70**: 50% CPU.
- Если имя пользователя заканчивается на **71-99**: 70% CPU.

```bash
apt-get install cgroup-tools

mkdir /sys/fs/cgroup/user-42
echo "50000 100000" | sudo tee /sys/fs/cgroup/user-42/cpu.max
```

## 2. Ограничение памяти для процесса (cgroups):

### 2.1 Создайте cgroup для ограничения памяти, потребляемой процессом

```bash
cgcreate -g memory:/cg42
```

### 2.2 Ограничьте потребление памяти следующим образом: ID*10 + 500 МБ (например, ID=23 → 730 МБ).

LIMIT_MB=$((42 * 10 + 500))   # → 920
LIMIT_BYTES=$((LIMIT_MB * 1024 * 1024))  # → 964689920

```bash
cgset -r memory.limit_in_bytes=964689920 cg42
```

### 3.3 Запустите процесс и переместите его в созданную вами группу.

```
cgexec -g memory:cg42 tail -f /dev/zero &
```

## 3. Ограничение дискового ввода-вывода для сценария резервного копирования (cgroups)

### 3.1 Скрипт резервного копирования (backup.sh) перегружает дисковую подсистему.

### 3.2 Ограничьте его до:
- Чтение: 1000 + <ID>*10 IOPS. (1420 IOPS)
- Запись: 500 + <ID>*10 IOPS. (920 IOPS)

### 3.3 Ограничьте его до:

```bash
cgcreate -g blkio:/backup
cgset -r blkio.throttle.read_iops_device="8:0 1420" backup
cgset -r blkio.throttle.write_iops_device="8:0 920" backup
```

### 3.4 Протестируйте с помощью fio или dd.

hey!

## 4. Закрепление к определенному ядру процессора для приложения

### 4.1 Настройте с помощью cgroups процесс команды top за процессором 0.

### 4.2 Используйте cpuset.cpus в cgroups.

### 4.3 Проверьте с помощью taskset -p <PID>. (требуется пакет sysstat)



